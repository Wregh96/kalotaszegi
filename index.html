<!DOCTYPE html>
<html lang="hu">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Kalotaszegi Régiségek</title>
<style>
  /* Reset & alap stílus */
  body {
    margin: 0; padding: 0;
    font-family: Georgia, serif;
    background-color: #f5f0e6;
    color: #3b2f2f;
  }
  header {
    background-color: #8b5e3c;
    color: white;
    padding: 20px 10px;
    text-align: center;
    font-size: 1.8rem;
    user-select: none;
  }
  nav {
    background-color: #d2b48c;
    display: flex;
    justify-content: center;
    gap: 15px;
    padding: 12px 5px;
    flex-wrap: wrap;
  }
  nav button {
    background: transparent;
    border: none;
    font-weight: bold;
    cursor: pointer;
    color: #3b2f2f;
    padding: 8px 16px;
    font-size: 1rem;
    border-radius: 6px;
    transition: background-color 0.25s ease;
  }
  nav button:hover,
  nav button.active {
    background-color: #8b5e3c;
    color: white;
  }
  main {
    max-width: 1024px;
    margin: 20px auto;
    padding: 0 15px 40px;
  }
  section {
    display: none;
  }
  section.active {
    display: block;
  }

  /* Főoldal slideshow */
  .gallery {
    position: relative;
    max-width: 100%;
    height: 280px;
    margin-bottom: 20px;
    overflow: hidden;
    border-radius: 10px;
    box-shadow: 0 4px 8px rgb(0 0 0 / 0.1);
    user-select: none;
  }
  .gallery img {
    width: 100%;
    height: 280px;
    object-fit: cover;
    transition: opacity 0.8s ease;
    position: absolute;
    top: 0; left: 0;
  }
  .gallery img.hidden {
    opacity: 0;
    pointer-events: none;
  }

  /* Termék lista */
  .product-list {
    display: flex;
    flex-wrap: wrap;
    gap: 18px;
    justify-content: center;
  }
  .product {
    width: 140px;
    border: 1px solid #aaa;
    padding: 8px 5px 10px;
    background: white;
    border-radius: 8px;
    box-shadow: 0 1px 3px rgb(0 0 0 / 0.1);
    cursor: pointer;
    text-align: center;
    user-select: none;
    transition: box-shadow 0.3s ease;
  }
  .product:hover {
    box-shadow: 0 4px 8px rgb(0 0 0 / 0.15);
  }
  .product .code {
    font-weight: bold;
    color: #8b5e3c;
    margin-bottom: 6px;
  }
  .product img {
    width: 100%;
    height: 90px;
    object-fit: cover;
    border-radius: 4px;
  }

  /* Kép kinagyítás modal */
  #modal {
    display: none;
    position: fixed;
    z-index: 999;
    inset: 0;
    background-color: rgba(0,0,0,0.8);
    align-items: center;
    justify-content: center;
  }
  #modal img {
    max-width: 90vw;
    max-height: 90vh;
    border-radius: 8px;
    box-shadow: 0 0 20px black;
  }
  #modal:target {
    display: flex;
  }
  #modal .close-btn {
    position: fixed;
    top: 20px; right: 20px;
    font-size: 2.5rem;
    color: white;
    cursor: pointer;
    user-select: none;
  }

  /* Admin */
  #adminPanel {
    max-width: 700px;
    margin: auto;
    background: #fff9f1;
    padding: 20px;
    border-radius: 10px;
    box-shadow: 0 0 15px rgba(139,94,60,0.4);
  }
  #adminPanel input[type="text"],
  #adminPanel input[type="password"],
  #adminPanel textarea,
  #adminPanel input[type="file"] {
    width: 100%;
    margin: 8px 0 14px 0;
    padding: 10px;
    font-size: 1rem;
    border: 1px solid #d2b48c;
    border-radius: 5px;
    font-family: Georgia, serif;
  }
  #adminPanel button {
    background-color: #8b5e3c;
    color: white;
    border: none;
    padding: 10px 20px;
    cursor: pointer;
    font-weight: bold;
    border-radius: 5px;
    transition: background-color 0.3s ease;
  }
  #adminPanel button:hover {
    background-color: #a77950;
  }
  #loginSection {
    max-width: 300px;
    margin: 30px auto;
    background: #fff9f1;
    padding: 20px;
    border-radius: 10px;
    box-shadow: 0 0 15px rgba(139,94,60,0.4);
  }

  /* Mobil optimalizáció */
  @media (max-width: 600px) {
    nav {
      gap: 8px;
      padding: 8px;
    }
    nav button {
      font-size: 0.9rem;
      padding: 6px 12px;
    }
    main {
      padding: 0 10px 30px;
    }
    .product {
      width: 45%;
    }
  }
</style>
</head>
<body>

<header>Kalotaszegi Régiségek</header>

<nav>
  <button data-section="fooldal" class="active">Főoldal</button>
  <button data-section="butorok">Bútorok</button>
  <button data-section="ruhak">Ruhák</button>
  <button data-section="disztargyak">Dísztárgyak</button>
  <button data-section="egyeb">Egyéb</button>
  <button data-section="kapcsolat">Kapcsolat</button>
  <button data-section="admin">Admin</button>
</nav>

<main>
  <section id="fooldal" class="active">
    <div class="gallery" aria-label="Főoldali képek">
      <!-- Slideshow képek kerülnek ide JS által -->
    </div>
    <p id="introText">Üdvözöljük a Kalotaszegi Régiségek weboldalán! Kézműves hagyomány, érték és történelem.</p>
  </section>

  <section id="butorok">
    <h2>Bútorok</h2>
    <div class="product-list" id="butorLista" aria-live="polite"></div>
  </section>

  <section id="ruhak">
    <h2>Ruhák</h2>
    <div class="product-list" id="ruhakLista" aria-live="polite"></div>
  </section>

  <section id="disztargyak">
    <h2>Dísztárgyak</h2>
    <div class="product-list" id="disztargyakLista" aria-live="polite"></div>
  </section>

  <section id="egyeb">
    <h2>Egyéb</h2>
    <div class="product-list" id="egyebLista" aria-live="polite"></div>
  </section>

  <section id="kapcsolat">
    <h2>Kapcsolat</h2>
    <p>Érdeklődés esetén kérjük írjon: <a href="mailto:info@kalotaszegiregisegek.hu">info@kalotaszegiregisegek.hu</a></p>
  </section>

  <section id="admin">
    <div id="loginSection">
      <h2>Admin Bejelentkezés</h2>
      <input type="password" id="adminPass" placeholder="Admin jelszó" autocomplete="off" aria-label="Admin jelszó" />
      <button id="loginBtn">Belépés</button>
    </div>

    <div id="adminPanel" style="display:none;">
      <h2>Admin szerkesztő</h2>

      <h3>Főoldali szöveg szerkesztése</h3>
      <textarea id="introEditor" rows="4" aria-label="Főoldali bemutatkozó szöveg"></textarea>
      <button id="saveIntroBtn">Mentés</button>

      <h3>Főoldali képek feltöltése</h3>
      <input type="file" id="mainImageUpload" accept="image/*" multiple aria-label="Főoldali képek feltöltése" />
      <button id="uploadMainImagesBtn">Feltöltés</button>

      <hr>

      <h3>Új termék hozzáadása</h3>

      <label for="categorySelect">Kategória:</label>
      <select id="categorySelect" aria-label="Termék kategória">
        <option value="butorok">Bútorok</option>
        <option value="ruhak">Ruhák</option>
        <option value="disztargyak">Dísztárgyak</option>
        <option value="egyeb">Egyéb</option>
      </select>

      <input type="text" id="productCode" placeholder="Termékszám (pl. #101)" aria-label="Termékszám" />
      <input type="text" id="productName" placeholder="Termék neve" aria-label="Termék neve" />
      <input type="file" id="productImage" accept="image/*" aria-label="Termék kép feltöltése" />
      <button id="addProductBtn">Hozzáadás</button>
    </div>
  </section>
</main>

<!-- Modal kinagyítás képekhez -->
<div id="modal" role="dialog" aria-modal="true" tabindex="-1">
  <span class="close-btn" role="button" aria-label="Bezárás">&times;</span>
  <img alt="" />
</div>

<script>
(() => {
  const ADMIN_PASSWORD = "590678601";

  // DOM elemek
  const navButtons = document.querySelectorAll("nav button");
  const sections = document.querySelectorAll("main section");
  const loginSection = document.getElementById("loginSection");
  const adminPanel = document.getElementById("adminPanel");
  const loginBtn = document.getElementById("loginBtn");
  const adminPassInput = document.getElementById("adminPass");

  const introText = document.getElementById("introText");
  const introEditor = document.getElementById("introEditor");
  const saveIntroBtn = document.getElementById("saveIntroBtn");

  const gallery = document.querySelector(".gallery");

  const mainImageUpload = document.getElementById("mainImageUpload");
  const uploadMainImagesBtn = document.getElementById("uploadMainImagesBtn");

  const categorySelect = document.getElementById("categorySelect");
  const productCodeInput = document.getElementById("productCode");
  const productNameInput = document.getElementById("productName");
  const productImageInput = document.getElementById("productImage");
  const addProductBtn = document.getElementById("addProductBtn");

  const modal = document.getElementById("modal");
  const modalImg = modal.querySelector("img");
  const modalCloseBtn = modal.querySelector(".close-btn");

  // Termék listák objektum formában
  let products = {
    butorok: [],
    ruhak: [],
    disztargyak: [],
    egyeb: [],
  };

  // Főoldali képek (több)
  let mainImages = [];

  // --- NAVIGATION ---
  navButtons.forEach(btn => {
    btn.addEventListener("click", () => {
      // Aktív gomb jelölése
      navButtons.forEach(b => b.classList.remove("active"));
      btn.classList.add("active");

      // Megjelenítés
      const target = btn.dataset.section;
      sections.forEach(sec => {
        if (sec.id === target) sec.classList.add("active");
        else sec.classList.remove("active");
      });

      // Fókusz az első elemre a megjelenített szekcióban (akadálymentesség)
      const activeSection = document.getElementById(target);
      const focusable = activeSection.querySelector("button, a, input, select, textarea");
      if (focusable) focusable.focus();
    });
  });

  // --- LOGIN ---
  loginBtn.addEventListener("click", () => {
    if (adminPassInput.value === ADMIN_PASSWORD) {
      loginSection.style.display = "none";
      adminPanel.style.display = "block";

      // Betöltjük az eddigi adatokat adminban
      introEditor.value = localStorage.getItem("introText") || introText.textContent;

      // Terméklisták feltöltése admin panelben nincs külön, mert a listák megjelennek a saját oldalukon
    } else {
      alert("Hibás jelszó!");
    }
    adminPassInput.value = "";
  });

  // --- Főoldali szöveg mentése ---
  saveIntroBtn.addEventListener("click", () => {
    const val = introEditor.value.trim();
    introText.textContent = val;
    localStorage.setItem("introText", val);
    alert("Főoldali bemutatkozó szöveg mentve!");
  });

  // --- Főoldali képek betöltése slideshow-ba ---
  function renderGallery() {
    gallery.innerHTML = "";
    mainImages.forEach((imgUrl, idx) => {
      const img = document.createElement("img");
      img.src = imgUrl;
      img.alt = `Főoldali kép ${idx + 1}`;
      img.style.opacity = idx === 0 ? "1" : "0";
      if (idx !== 0) img.classList.add("hidden");
      gallery.appendChild(img);
    });
  }

  let slideIndex = 0;
  function nextSlide() {
    if (mainImages.length <= 1) return;
    const imgs = gallery.querySelectorAll("img");
<script>
  // Slideshow váltása
  function nextSlide() {
    const imgs = gallery.querySelectorAll("img");
    if (imgs.length === 0) return;

    imgs[slideIndex].classList.add("hidden");
    slideIndex = (slideIndex + 1) % imgs.length;
    imgs[slideIndex].classList.remove("hidden");
  }
  setInterval(nextSlide, 4000);

  // Főoldali képek betöltése localStorage-ból
  const storedMainImages = localStorage.getItem("mainImages");
  if (storedMainImages) {
    mainImages = JSON.parse(storedMainImages);
    renderGallery();
  }

  // Főoldali kép feltöltés
  uploadMainImagesBtn.addEventListener("click", () => {
    const files = mainImageUpload.files;
    if (!files.length) return alert("Nincs kiválasztva kép.");

    for (let file of files) {
      const reader = new FileReader();
      reader.onload = (e) => {
        mainImages.push(e.target.result);
        localStorage.setItem("mainImages", JSON.stringify(mainImages));
        renderGallery();
      };
      reader.readAsDataURL(file);
    }
    alert("Képek feltöltve!");
    mainImageUpload.value = "";
  });

  // Termék hozzáadása
  addProductBtn.addEventListener("click", () => {
    const cat = categorySelect.value;
    const code = productCodeInput.value.trim();
    const name = productNameInput.value.trim();
    const file = productImageInput.files[0];

    if (!code || !name || !file) return alert("Tölts ki minden mezőt!");

    const reader = new FileReader();
    reader.onload = (e) => {
      const newProduct = { code, name, image: e.target.result };
      products[cat].push(newProduct);
      localStorage.setItem("products", JSON.stringify(products));
      renderProducts();
      alert("Termék hozzáadva!");
    };
    reader.readAsDataURL(file);

    // Tisztítás
    productCodeInput.value = "";
    productNameInput.value = "";
    productImageInput.value = "";
  });

  // Termék megjelenítés
  function renderProducts() {
    for (let cat in products) {
      const container = document.getElementById(`${cat}Lista`);
      container.innerHTML = "";
      products[cat].forEach((p, i) => {
        const div = document.createElement("div");
        div.className = "product";
        div.innerHTML = `
          <div class="code">${p.code}</div>
          <img src="${p.image}" alt="${p.name}" tabindex="0" />
        `;
        div.querySelector("img").addEventListener("click", () => {
          modal.style.display = "flex";
          modalImg.src = p.image;
          modalImg.alt = p.name;
        });
        container.appendChild(div);
      });
    }
  }

  // Termékek betöltése
  const storedProducts = localStorage.getItem("products");
  if (storedProducts) {
    products = JSON.parse(storedProducts);
    renderProducts();
  }

  // Modal zárás
  modalCloseBtn.addEventListener("click", () => {
    modal.style.display = "none";
  });
  modal.addEventListener("click", (e) => {
    if (e.target === modal) modal.style.display = "none";
  });

  // Mentett bemutatkozó szöveg betöltése
  const savedIntro = localStorage.getItem("introText");
  if (savedIntro) introText.textContent = savedIntro;

</script>
</body>
</html>
